[
  {
    "objectID": "projects.html",
    "href": "projects.html",
    "title": "Projects",
    "section": "",
    "text": "Date\n\n\n\nTitle\n\n\n\nAuthor\n\n\n\n\n\n\n\n\n07-24-2025\n\n\nLC-MS data\n\n\nJinYoung Park\n\n\n\n\n\n\n \n\n\nnumber 2\n\n\n \n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "projects/Class_presentation.html",
    "href": "projects/Class_presentation.html",
    "title": "LC-MS data",
    "section": "",
    "text": "##On this page\nThe objective of this experiment is to figure out the metabolite that changes during the planaria regeneration.\n##Experiment design  after dissecting the planaria, we isolated metabolites using organic solvent (40% methanol, 40% acetonitrile, 20% water) and ran LC-MS\n##How to get csv files LS-MS raw data has been processed by the program El-MAVEN\nChecking the peak and selecting the metabolite for export\nAs a result, we got the file for Negative mode and Positive mode CSV files."
  },
  {
    "objectID": "projects/Class_presentation.html#package-used",
    "href": "projects/Class_presentation.html#package-used",
    "title": "LC-MS data",
    "section": "Package Used",
    "text": "Package Used\n\nlibrary(tidyverse)\nlibrary(tidymodels)"
  },
  {
    "objectID": "projects/Class_presentation.html#loading-data",
    "href": "projects/Class_presentation.html#loading-data",
    "title": "LC-MS data",
    "section": "Loading Data",
    "text": "Loading Data\n\nID &lt;- read.csv(\"csv/BOA Team Metabolomics Master Sample Decode.csv\")\ndata &lt;- read.csv(\"csv/MBL BoA Run 2 Neg.csv\")\ndataPos &lt;- read.csv(\"csv/MBL BoA Run 2 Pos.csv\")\n\n#split planaria data from the scan\npladata &lt;- data %&gt;% \n  select(compound, any_of(ID$sampleId))\n\npladataPos &lt;- dataPos %&gt;% \n  select(compound, any_of(ID$sampleId))\n\ndim(pladata)\n\n[1] 332  13\n\nhead(ID)\n\n  sampleId organism time\n1       H1 Planaria  48h\n2       H2 Planaria  48h\n3       H3 Planaria  48h\n4       H4 Planaria  24h\n5       H5 Planaria  24h\n6       H6 Planaria  24h\n\nhead(pladata)\n\n                 compound         H1         H2          H3          H4\n1                 Lys-Gly    2981.73    1238.38     3707.89     2742.60\n2        Guaiacol sulfate 7949037.50 8290242.50  9839327.00  3491165.25\n3 gamma-D-Glutamylglycine   11086.11    9095.29    14769.42     3645.59\n4           Pyruvaldehyde 4452229.00 7631652.00 19501670.00 13609840.00\n5           Pyruvaldehyde   34609.73   32013.19    39391.17    25568.62\n6                 Thr-Ser   22430.83   47572.16   158337.00    15474.27\n          H5         H6         H7         H8         H9        H10        H11\n1    3549.62    3119.03    3299.75    1764.37    2815.06    3345.15    3481.38\n2 3906389.25 3854228.75  767042.50  359245.97  346187.22  192914.30  211295.05\n3    8944.09    6949.73   11951.37   15545.66   12036.11    5553.02   12051.67\n4 2178963.25 7550432.50 7503210.00 3826928.00 9757209.00 2973543.25 3843370.00\n5   41102.38   34531.29   61404.99   89532.27   68340.44   62602.42  114659.41\n6   23494.05   40796.89   54462.92   52808.92   38236.62    5699.68   63685.97\n          H12\n1     1589.99\n2   185684.77\n3     5604.41\n4 10284963.00\n5    66236.09\n6     2856.74\n\nhead(pladataPos)\n\n           compound          H1          H2          H3          H4          H5\n1 L-Acetylcarnitine 25985552.00 21960242.00 50695804.00 26427728.00 44779756.00\n2           Lys-Gly        0.00     7591.37        0.00     6314.98        0.00\n3 Indolelactic acid 21485140.00 14464097.00  9966840.00 15573748.00 23545242.00\n4 Homoveratric acid    57538.22    82618.37   139253.61   233296.38   139381.39\n5   L-Cystathionine        0.00        0.00    11889.33        0.00    42778.96\n6   Phosphocreatine    23407.13    20181.28        0.00    10254.64     6442.96\n           H6          H7          H8          H9         H10         H11\n1 40070484.00 55911796.00 33104704.00 43227828.00 28190656.00 52814924.00\n2     5823.23     6385.86        0.00     6622.23     7051.88    13724.76\n3 11170373.00  8759365.00 12555552.00 13066624.00 11561643.00 12169792.00\n4   113386.03   210541.02   101928.29   123154.44   101622.59   106338.81\n5        0.00    10436.00    27617.32    12184.07    12957.47    27457.91\n6        0.00        0.00        0.00        0.00        0.00        0.00\n          H12\n1 21859992.00\n2     6000.29\n3 15590261.00\n4   176507.73\n5        0.00\n6        0.00\n\nplaData &lt;- rbind(pladata, pladataPos)\nplaData$compound &lt;- make.unique(plaData$compound)\n\ndim(plaData)\n\n[1] 497  13\n\nplaDataLong &lt;- pivot_longer(plaData,cols = c(2:13), names_to = \"sampleId\", values_to = \"IC\")\n\nplaDataLong &lt;- merge(plaDataLong, ID, by = \"sampleId\")\n\ndim(plaDataLong)\n\n[1] 5964    5\n\nhead(plaDataLong)\n\n  sampleId                compound          IC organism time\n1       H1                 Lys-Gly     2981.73 Planaria  48h\n2       H1       Indolelactic acid 21485140.00 Planaria  48h\n3       H1   4-Methylene-glutamine    59445.56 Planaria  48h\n4       H1            LysoPC(20:0)   451422.25 Planaria  48h\n5       H1                PE(38:3)   790601.50 Planaria  48h\n6       H1 N-Acetylneuraminic acid    15776.14 Planaria  48h"
  },
  {
    "objectID": "projects/Class_presentation.html#prep-the-data",
    "href": "projects/Class_presentation.html#prep-the-data",
    "title": "LC-MS data",
    "section": "Prep the Data",
    "text": "Prep the Data\n\n#set a seed in order to make the analysis reproducible\nset.seed(11)\n\n# change into wide\ncolnames(plaDataLong)\n\n[1] \"sampleId\" \"compound\" \"IC\"       \"organism\" \"time\"    \n\nplaDataWide &lt;- plaDataLong %&gt;%\n  pivot_wider(\n    id_cols = c(sampleId, organism, time), \n    names_from = compound,\n    values_from = IC)\n\nhead(plaDataWide)\n\n# A tibble: 6 × 500\n  sampleId organism time  `Lys-Gly` `Indolelactic acid` `4-Methylene-glutamine`\n  &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;               &lt;dbl&gt;                   &lt;dbl&gt;\n1 H1       Planaria 48h       2982.            21485140                  59446.\n2 H10      Planaria 0h        3345.            11561643                  43536.\n3 H11      Planaria 0h        3481.            12169792                  46302.\n4 H12      Planaria 0h        1590.            15590261                  35571.\n5 H2       Planaria 48h       1238.            14464097                  58614.\n6 H3       Planaria 48h       3708.             9966840                  85028.\n# ℹ 494 more variables: `LysoPC(20:0)` &lt;dbl&gt;, `PE(38:3)` &lt;dbl&gt;,\n#   `N-Acetylneuraminic acid` &lt;dbl&gt;, `Glycerol 3-phosphate` &lt;dbl&gt;,\n#   Dodecanoylcarnitine &lt;dbl&gt;, Trigonelline.1 &lt;dbl&gt;, `C24:5` &lt;dbl&gt;,\n#   Uracil &lt;dbl&gt;, Fructoseglycine &lt;dbl&gt;, `Guaiacol sulfate` &lt;dbl&gt;,\n#   `Homoveratric acid` &lt;dbl&gt;, NAD &lt;dbl&gt;, `carnitine C26:0` &lt;dbl&gt;,\n#   `PE(P-18:1/22:6)` &lt;dbl&gt;, `C20:1` &lt;dbl&gt;, `D-Ribose` &lt;dbl&gt;,\n#   `Dihydroceramide C2` &lt;dbl&gt;, Niacinamide.1 &lt;dbl&gt;, …\n\n# generate reciepe\npca_recipe &lt;- recipe(~ ., data = plaDataWide) %&gt;%\n  update_role(sampleId, organism, time, new_role = \"id\")\n\nsummary(pca_recipe)\n\n# A tibble: 500 × 4\n   variable                type      role      source  \n   &lt;chr&gt;                   &lt;list&gt;    &lt;chr&gt;     &lt;chr&gt;   \n 1 sampleId                &lt;chr [3]&gt; id        original\n 2 organism                &lt;chr [3]&gt; id        original\n 3 time                    &lt;chr [3]&gt; id        original\n 4 Lys-Gly                 &lt;chr [2]&gt; predictor original\n 5 Indolelactic acid       &lt;chr [2]&gt; predictor original\n 6 4-Methylene-glutamine   &lt;chr [2]&gt; predictor original\n 7 LysoPC(20:0)            &lt;chr [2]&gt; predictor original\n 8 PE(38:3)                &lt;chr [2]&gt; predictor original\n 9 N-Acetylneuraminic acid &lt;chr [2]&gt; predictor original\n10 Glycerol 3-phosphate    &lt;chr [2]&gt; predictor original\n# ℹ 490 more rows\n\npca_recipe &lt;- recipe(~ ., data = plaDataWide) %&gt;%\n  update_role(sampleId, organism, time, new_role = \"id\") %&gt;% \n  step_scale(all_predictors()) %&gt;%  \n  step_center(all_predictors()) %&gt;%\n  step_pca(all_predictors(), id = \"pca\")\n\npca_recipe\n\n# apply recipe\npca_prepped &lt;- prep(pca_recipe)\npca_prepped\npca_baked &lt;- bake(pca_prepped, plaDataWide)\npca_baked\n\n# A tibble: 12 × 8\n   sampleId organism time       PC1    PC2      PC3   PC4     PC5\n   &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;\n 1 H1       Planaria 48h   -12.1    -5.59  -10.4    -3.27 -3.94  \n 2 H10      Planaria 0h      9.89   -5.25    0.791  -3.62 10.4   \n 3 H11      Planaria 0h     29.1     5.26   -1.17    3.92 -6.16  \n 4 H12      Planaria 0h     -0.0141 -4.93   11.9    -9.59 -8.38  \n 5 H2       Planaria 48h   -14.6    -2.58   -4.47   -2.69 -1.35  \n 6 H3       Planaria 48h   -10.1    23.2    -1.21   -1.99 -0.0971\n 7 H4       Planaria 24h   -12.1    -1.16   13.4     9.50  1.43  \n 8 H5       Planaria 24h    -0.583  -6.20   -5.86   11.9  -3.77  \n 9 H6       Planaria 24h    -7.35   -2.38   -0.0663  1.83  2.68  \n10 H7       Planaria 6h      5.30    2.70    0.333   3.12  3.34  \n11 H8       Planaria 6h      7.31   -2.16   -2.03   -5.17 -2.86  \n12 H9       Planaria 6h      5.26   -0.919  -1.21   -3.92  8.70"
  },
  {
    "objectID": "projects/Class_presentation.html#visualization-of-pca-plot",
    "href": "projects/Class_presentation.html#visualization-of-pca-plot",
    "title": "LC-MS data",
    "section": "Visualization of PCA plot",
    "text": "Visualization of PCA plot\n\nggplot(pca_baked, aes(x = PC1, y = PC2, color = time)) +\n  geom_point(size = 3, alpha = 0.8) +\n  theme_minimal() +\n  labs(title = \"PCA of LC-MS IC values\", x = \"PC1\", y = \"PC2\")\n\n\n\n\n\n\n\nggplot(pca_baked, aes(x = PC1, y = PC3, color = time, label = sampleId)) +\n  geom_point(size = 3, alpha = 0.8) +\n  geom_text(check_overlap = TRUE, color = \"black\", nudge_y = 1) +\n  theme_minimal() +\n  labs(title = \"PCA of LC-MS IC values\", x = \"PC1\", y = \"PC3\")"
  },
  {
    "objectID": "projects/Class_presentation.html#volcano-plot",
    "href": "projects/Class_presentation.html#volcano-plot",
    "title": "LC-MS data",
    "section": "Volcano Plot",
    "text": "Volcano Plot\n\nregFxn &lt;- possibly(function(dat){\n  lm(log2(IC+0.01) ~ time, data = dat) %&gt;% \n    broom::tidy()\n}, otherwise = NULL)\n\nplanStats &lt;- plaDataLong %&gt;% \n  nest(statData = -compound) %&gt;% \n  mutate(df = map(statData, regFxn)) %&gt;% \n  unnest_legacy(df) %&gt;% \n  filter(term != \"(Intercept)\") %&gt;% \n  mutate(p.adj = p.adjust(p.value, method = \"BH\"))\n\nhead(planStats)\n\n# A tibble: 6 × 7\n  compound          term    estimate std.error statistic p.value p.adj\n  &lt;chr&gt;             &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;\n1 Lys-Gly           time24h   0.238      0.476     0.499   0.631 0.921\n2 Lys-Gly           time48h  -0.145      0.476    -0.305   0.768 0.985\n3 Lys-Gly           time6h   -0.0587     0.476    -0.123   0.905 1    \n4 Indolelactic acid time24h   0.300      0.354     0.848   0.421 0.792\n5 Indolelactic acid time48h   0.166      0.354     0.469   0.652 0.936\n6 Indolelactic acid time6h   -0.203      0.354    -0.575   0.581 0.900\n\nplanStats %&gt;% \n  mutate(term = factor(term,\n                       levels = c(\"time6h\", \n                                  \"time24h\", \n                                  \"time48h\"))) %&gt;% \n  ggplot(aes(x = estimate, y = -log10(p.adj), label = compound)) +\n  geom_point() +\n  facet_wrap(~term) +\n  geom_hline(yintercept = 1.3)"
  },
  {
    "objectID": "projects/Class_presentation.html#top-5-highest-p.adjust-value-compound",
    "href": "projects/Class_presentation.html#top-5-highest-p.adjust-value-compound",
    "title": "LC-MS data",
    "section": "Top 5 highest p.adjust value compound",
    "text": "Top 5 highest p.adjust value compound\n\ntop5_padj &lt;- planStats %&gt;%\n  group_by(term) %&gt;% \n  arrange(p.adj) %&gt;% \n  slice_head(n = 5)\n\nhead(top5_padj)\n\n# A tibble: 6 × 7\n# Groups:   term [2]\n  compound          term    estimate std.error statistic      p.value     p.adj\n  &lt;chr&gt;             &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;\n1 Guaiacol sulfate  time24h     4.25     0.278     15.3  0.000000329  0.000245 \n2 Tyrosol 4-sulfate time24h     4.03     0.426      9.46 0.0000128    0.00478  \n3 dGDP              time24h    -2.55     0.339     -7.52 0.0000678    0.00842  \n4 ADP               time24h    -2.55     0.339     -7.52 0.0000678    0.00842  \n5 L-Aspartic acid.1 time24h    -1.78     0.254     -7.00 0.000113     0.0112   \n6 Guaiacol sulfate  time48h     5.46     0.278     19.7  0.0000000466 0.0000695\n\ntop5_padj %&gt;% \n  filter(estimate != 0) %&gt;% \n  ggplot(aes(x= compound, y = estimate)) +\n  geom_bar(stat = \"identity\", color = \"blue\") +\n  labs(title = \"Top 5 highest p-adj's estimate\", x = \"compound\", y = \"estimate\") + theme_minimal() + facet_grid(~term) + coord_flip()"
  },
  {
    "objectID": "projects/Class_presentation.html#take-a-look-individual-compound",
    "href": "projects/Class_presentation.html#take-a-look-individual-compound",
    "title": "LC-MS data",
    "section": "Take a look individual compound",
    "text": "Take a look individual compound\n\nplanStats %&gt;% \n  group_by(compound) %&gt;% \n  arrange(p.adj)\n\n# A tibble: 1,491 × 7\n# Groups:   compound [497]\n   compound                 term    estimate std.error statistic p.value   p.adj\n   &lt;chr&gt;                    &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n 1 Guaiacol sulfate         time48h     5.46     0.278     19.7  4.66e-8 6.95e-5\n 2 Guaiacol sulfate         time24h     4.25     0.278     15.3  3.29e-7 2.45e-4\n 3 Tyrosol 4-sulfate        time48h     5.24     0.426     12.3  1.78e-6 8.86e-4\n 4 Tyrosol 4-sulfate        time24h     4.03     0.426      9.46 1.28e-5 4.78e-3\n 5 dGDP                     time48h    -2.94     0.339     -8.66 2.46e-5 5.18e-3\n 6 ADP                      time48h    -2.94     0.339     -8.66 2.46e-5 5.18e-3\n 7 Hydroxymethylphosphonate time48h    -1.35     0.159     -8.51 2.78e-5 5.18e-3\n 8 Acetylphosphate          time48h    -1.75     0.205     -8.54 2.71e-5 5.18e-3\n 9 Sedoheptulose            time48h     1.19     0.149      8.04 4.23e-5 6.30e-3\n10 Phosphoglycolic acid     time48h    -1.90     0.234     -8.12 3.93e-5 6.30e-3\n# ℹ 1,481 more rows\n\nhead(planStats)\n\n# A tibble: 6 × 7\n  compound          term    estimate std.error statistic p.value p.adj\n  &lt;chr&gt;             &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;\n1 Lys-Gly           time24h   0.238      0.476     0.499   0.631 0.921\n2 Lys-Gly           time48h  -0.145      0.476    -0.305   0.768 0.985\n3 Lys-Gly           time6h   -0.0587     0.476    -0.123   0.905 1    \n4 Indolelactic acid time24h   0.300      0.354     0.848   0.421 0.792\n5 Indolelactic acid time48h   0.166      0.354     0.469   0.652 0.936\n6 Indolelactic acid time6h   -0.203      0.354    -0.575   0.581 0.900\n\nplaDataLong %&gt;% \n  mutate(time = factor(levels = c(\"0h\",\"6h\",\"24h\",\"48h\"), time)) %&gt;% \n  filter(compound == \"Guaiacol sulfate\") %&gt;% \n  ggplot(aes(x = compound, y = IC, fill = time)) +\n  geom_bar(stat = \"summary\", fun = mean,\n           position = position_dodge(), color = \"black\") +\n  geom_point(position = position_dodge(width = 1)) + \n  facet_wrap(~organism, scales = \"free\") +\n  theme(axis.text.x = element_text(angle = 45, \n                                   vjust = 1, \n                                   hjust=1),\n        axis.text = element_text(color = \"black\", size = 14)) +\n  labs(title = \"Most changed compound during regeneration\") \n\n\n\n\n\n\n\n\nThen, let’s search Google about what this compound is! Guaiacol Sulfate"
  },
  {
    "objectID": "publication.html",
    "href": "publication.html",
    "title": "Publication",
    "section": "",
    "text": "No matching items"
  }
]